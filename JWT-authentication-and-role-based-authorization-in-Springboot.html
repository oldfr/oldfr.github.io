<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>JWT authentication and role-based authorization in Springboot</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">JWT authentication and role-based authorization in Springboot</h1>
</header>
<section data-field="subtitle" class="p-summary">
Hey There, as you might also feel configuring authentication and authorization is always been the most confusing task in java. It involves…
</section>
<section data-field="body" class="e-content">
<section name="1c29" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="53b7" id="53b7" class="graf graf--h3 graf--leading graf--title">JWT authentication and role-based authorization in Springboot</h3><figure name="9db0" id="9db0" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="0*zUg28HNOl2ZwPVMp" data-width="7952" data-height="5304" data-unsplash-photo-id="mT7lXZPjk7U" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*zUg28HNOl2ZwPVMp"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@flyd2069?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com/@flyd2069?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-creator noopener" target="_blank">FLY:D</a> on <a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-source noopener" target="_blank">Unsplash</a></figcaption></figure><p name="35d1" id="35d1" class="graf graf--p graf-after--figure">Hey There, as you might also feel configuring authentication and authorization is always been the most confusing task in java. It involves many classes and a person will get lost till he reaches the end. Let&#39;s look at JWT authentication in the Springboot application in a simpler way.</p><p name="0b32" id="0b32" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Background:</strong></p><p name="f756" id="f756" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Authentication:</strong> Check if you are allowed to access the application</p><p name="9d86" id="9d86" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Authorization:</strong> Decide what part of the application you can access based on your role.</p><p name="a467" id="a467" class="graf graf--p graf-after--p graf--trailing">Different ways to authenticate include: basic authentication(username and password), token-based authentication, API key, O-Auth and others. For more information about JWT authentication, you can refer <a href="https://jwt.io/introduction" data-href="https://jwt.io/introduction" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a>.</p></div></div></section><section name="1c41" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="bcd2" id="bcd2" class="graf graf--p graf--leading"><strong class="markup--strong markup--p-strong">Simple Springboot Application:</strong></p><p name="2e34" id="2e34" class="graf graf--p graf-after--p">Create a simple Springboot application with endpoints to access or update University data (stored in the “University” table). And, we want these endpoints to be accessed only with the correct token. For JWT we will have a separate table ( stored in the “UserData” table) to store credentials and roles. The overall implementation looks something like below:</p><figure name="ccab" id="ccab" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*rqWF78kmJp6SdG0zAnC1iA.png" data-width="765" data-height="751" src="https://cdn-images-1.medium.com/max/800/1*rqWF78kmJp6SdG0zAnC1iA.png"></figure><p name="eef3" id="eef3" class="graf graf--p graf-after--figure">We will follow below steps:</p><p name="b0df" id="b0df" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Step1: </strong>Enable security in the Springboot application</p><p name="d636" id="d636" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Step2: </strong>Setup the in-memory H2 database tables with SQL scripts</p><p name="6649" id="6649" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Step3: </strong>Implement JWT authentication</p><p name="bd40" id="bd40" class="graf graf--p graf-after--p graf--trailing"><strong class="markup--strong markup--p-strong">Step4: </strong>Extend it to consider role-based access (optional)</p></div></div></section><section name="af70" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="d342" id="d342" class="graf graf--p graf--leading"><strong class="markup--strong markup--p-strong">Step1: Enable security in the Springboot application</strong></p><p name="3171" id="3171" class="graf graf--p graf-after--p">First of all, we need Spring security jars. Include the below dependency in the pom.xml file.</p><pre name="6f7d" id="6f7d" class="graf graf--pre graf-after--p">&lt;dependency&gt;<br>   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br>   &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;<br>&lt;/dependency&gt;</pre><p name="b0f0" id="b0f0" class="graf graf--p graf-after--pre">In this jar, we have one abstract class <strong class="markup--strong markup--p-strong">WebSecurityConfigurerAdapter</strong>, using which we can configure the security of the whole application. By default, authentication is disabled. To enable it we need to customize the implementation of methods in this class. You can refer to available options in the <a href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/web/configuration/WebSecurityConfigurerAdapter.html" data-href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/web/configuration/WebSecurityConfigurerAdapter.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">official documentation</a>.</p><p name="ab47" id="ab47" class="graf graf--p graf-after--p">Extend the class <strong class="markup--strong markup--p-strong">WebSecurityConfigurerAdapter </strong>and override the methods</p><ol class="postList"><li name="cb93" id="cb93" class="graf graf--li graf-after--p">authenticationManagerBean() — to get Bean of AuthenticationManager</li><li name="a9c0" id="a9c0" class="graf graf--li graf-after--li">configure(HttpSecurity httpSecurity) — To allow or restrict any endpoint for authentication.</li></ol><figure name="b6c9" id="b6c9" class="graf graf--figure graf--iframe graf-after--li"><script src="https://gist.github.com/oldfr/3a95282802fe7dd32b33de7d2e85b7a9.js"></script></figure><p name="5659" id="5659" class="graf graf--p graf-after--figure">In the above code snippet, the annotation<em class="markup--em markup--p-em"> @EnableWebSecurity </em>is used to enable the security of the Application. As you might guess, we need not authenticate the endpoint used to get the token (“/authenticate”). Also, since we are using the H2 database, we have to allow access to it as well (“/h2-console/*).</p><p name="bd6e" id="bd6e" class="graf graf--p graf-after--p">Optional configurations:</p><ol class="postList"><li name="f93a" id="f93a" class="graf graf--li graf-after--p">Since this application will be used by non-browser clients, we can disable csrf.</li><li name="9d02" id="9d02" class="graf graf--li graf-after--li">In case of unauthorized access, we can customize the error message in response by implementing an interface AuthenticationEntryPoint.</li><li name="0746" id="0746" class="graf graf--li graf-after--li">If we do not want to store user state, we can make it a stateless session.</li></ol><p name="1e0f" id="1e0f" class="graf graf--p graf-after--li graf--trailing">For each request to the application, token validation and setting the authentication in context will be done in a customized filter <strong class="markup--strong markup--p-strong">JwtRequestFilter.java </strong>added before UsernamePasswordAuthenticationFilter</p></div></div></section><section name="75cf" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="47f1" id="47f1" class="graf graf--p graf--leading"><strong class="markup--strong markup--p-strong">Step2: Setup the in-memory H2 database tables with SQL scripts</strong></p><p name="b5b5" id="b5b5" class="graf graf--p graf-after--p">In <code class="markup--code markup--p-code">application.properties</code> or <code class="markup--code markup--p-code">application.yml</code> file, include H2 database connection details, JWT secret and port number:</p><figure name="aec2" id="aec2" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/oldfr/a72978b9d92a5a478343060ecb357cdf.js"></script></figure><p name="0ffc" id="0ffc" class="graf graf--p graf-after--figure">Let&#39;s have some tables be loaded once the application starts. As mentioned above we will have two tables. So, include the below SQL scripts in the resources folder:</p><p name="b9e1" id="b9e1" class="graf graf--p graf-after--p">schema.sql :</p><figure name="eed6" id="eed6" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/oldfr/52a43edb17ff747b9c7391c105a99bea.js"></script></figure><p name="1d9a" id="1d9a" class="graf graf--p graf-after--figure">To have some initial data in tables:</p><p name="2809" id="2809" class="graf graf--p graf-after--p">data.sql:</p><figure name="31c7" id="31c7" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/oldfr/fc20eae91cd929e156bafbe6c53c3b8a.js"></script></figure><p name="07c2" id="07c2" class="graf graf--p graf-after--figure">Also, create corresponding POJO classes(UserData.java and UniversityDB.java) and interfaces(UserDataRepo.java and UniversityRepo.java) implementing JpaRepository to perform DAO operations.</p><blockquote name="e5a7" id="e5a7" class="graf graf--blockquote graf-after--p graf--trailing"><strong class="markup--strong markup--blockquote-strong">Note: </strong>For more details on sql script execution on application start-up refer <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/howto.html#howto.data-initialization.using-basic-sql-scripts" data-href="https://docs.spring.io/spring-boot/docs/current/reference/html/howto.html#howto.data-initialization.using-basic-sql-scripts" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank">Spring documentation</a></blockquote></div></div></section><section name="a867" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="44b6" id="44b6" class="graf graf--p graf--leading">As mentioned above, let us have one POST endpoint (“<em class="markup--em markup--p-em">/authenticate</em>”) for authentication purposes, which accepts username and password. If they are genuine, it returns the token. The returned token could be used to access university endpoints of the application till gets expired(if configured to expire within some specified time).</p><p name="c6f2" id="c6f2" class="graf graf--p graf-after--p">The credentials passed in the authentication endpoint will be validated in UserDetailsService bean as below:</p><figure name="365d" id="365d" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/oldfr/b372959822055a931c503064c7668c58.js"></script></figure><p name="1827" id="1827" class="graf graf--p graf-after--figure graf--trailing">In the above code, we can pass an empty list if role-based authorization is not required while creating a User object.</p></div></div></section><section name="c877" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="a652" id="a652" class="graf graf--p graf--leading"><strong class="markup--strong markup--p-strong">Step3: Implement JWT authentication</strong></p><p name="d543" id="d543" class="graf graf--p graf-after--p">Create an endpoint “/authenticate” which accepts login credentials in the body. Authenticate the username and password. Fetch all details about a user from the H2 database and generate a token using jwt-secret from properties file. Send the token as a response.</p><figure name="2cc8" id="2cc8" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/oldfr/6e3ab739677fdad9b43b728942c966d7.js"></script></figure><p name="0a73" id="0a73" class="graf graf--p graf-after--figure">The token generation can be customized as below:</p><figure name="cbc2" id="cbc2" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/oldfr/4f81e6da96e576397227ce8175075e5a.js"></script></figure><p name="2994" id="2994" class="graf graf--p graf-after--figure">In the above code, we customized the token to expiration time to 5 hours.</p><p name="eb1a" id="eb1a" class="graf graf--p graf-after--p">The above token validation is invoked as part of filter JwtRequestFilter:</p><figure name="5304" id="5304" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/oldfr/c42a9ad6913680284f18c74fd52d507d.js"></script></figure><p name="a7d7" id="a7d7" class="graf graf--p graf-after--figure">The main business API endpoint calls:</p><figure name="6071" id="6071" class="graf graf--figure graf--iframe graf-after--p"><script src="https://gist.github.com/oldfr/9d5af4a75aa15988b74ba848488ee0f8.js"></script></figure><p name="f0cf" id="f0cf" class="graf graf--p graf-after--figure graf--trailing">You will be able to get the response after providing the token in above API calls.</p></div></div></section><section name="54c0" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="c528" id="c528" class="graf graf--p graf--leading"><strong class="markup--strong markup--p-strong">Step4: Extend it to consider role-based access(Optional)</strong></p><p name="96a1" id="96a1" class="graf graf--p graf-after--p">Now, the user has been authenticated to access the application. Based on his role, he will get access to parts of the application. For example, only admin can access the DELETE endpoints, users with EDITOR role can only call POST endpoints and other normal users can only see the data i.e, invoke only GET endpoints. Just an example :-).</p><blockquote name="1684" id="1684" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong">Note: </strong>Spring security adds the prefix “<strong class="markup--strong markup--blockquote-strong">ROLE_</strong>” by default to user roles.</blockquote><p name="2880" id="2880" class="graf graf--p graf-after--blockquote">To include the user roles in token generated, uncomment the code in generateToken() of JwtTokenUtil.java class.</p><p name="d4b8" id="d4b8" class="graf graf--p graf-after--p">To consider roles while accessing university endpoints,</p><ul class="postList"><li name="207a" id="207a" class="graf graf--li graf-after--p">Add<em class="markup--em markup--li-em"> annotation </em><a href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/method/configuration/EnableGlobalMethodSecurity.html" data-href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/method/configuration/EnableGlobalMethodSecurity.html" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank"><em class="markup--em markup--li-em">@EnableGlobalMethodSecurity(prePostEnabled = true)</em></a><em class="markup--em markup--li-em"> </em>to configuration class</li><li name="3934" id="3934" class="graf graf--li graf-after--li">Add annotation <a href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/access/prepost/PreAuthorize.html" data-href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/access/prepost/PreAuthorize.html" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">@<em class="markup--em markup--li-em">PreAuthorize</em></a><em class="markup--em markup--li-em"> </em>to university endpoints with required roles allowed (Here just uncomment annotations) — To check authority before invoking the method</li></ul><p name="ab7b" id="ab7b" class="graf graf--p graf-after--li">Now, only the user with a specified role can access the endpoints.</p><p name="2948" id="2948" class="graf graf--p graf-after--p">Thank you for reading. Happy exploring!!!</p><p name="4298" id="4298" class="graf graf--p graf-after--p graf--trailing">The complete code with role-based authorization can be found on GitHub <a href="https://github.com/oldfr/jwt-authentication-overview" data-href="https://github.com/oldfr/jwt-authentication-overview" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a></p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@ankithahjpgowda" class="p-author h-card">Ankitha Gowda</a> on <a href="https://medium.com/p/5aa13d7f35ce"><time class="dt-published" datetime="2022-03-03T08:15:31.642Z">March 3, 2022</time></a>.</p><p><a href="https://medium.com/@ankithahjpgowda/jwt-authentication-and-role-based-authorization-in-springboot-5aa13d7f35ce" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 9, 2025.</p></footer></article></body></html>