<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Policies of ThreadPoolExecutor in Java</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Policies of ThreadPoolExecutor in Java</h1>
</header>
<section data-field="subtitle" class="p-summary">
Multithreading framework allows us to perform tasks in parallel leading to enhanced performance with improved latency.
</section>
<section data-field="body" class="e-content">
<section name="ab37" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="c08c" id="c08c" class="graf graf--h3 graf--leading graf--title">Policies of ThreadPoolExecutor in Java</h3><figure name="a32e" id="a32e" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="0*M1iULMXLI9MGPc-A" data-width="3089" data-height="2048" data-unsplash-photo-id="ZzOtl6FSpLs" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*M1iULMXLI9MGPc-A"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@forest_ms?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com/@forest_ms?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-creator noopener" target="_blank">Forest Simon</a> on <a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-source noopener" target="_blank">Unsplash</a></figcaption></figure><p name="ce9e" id="ce9e" class="graf graf--p graf-after--figure">Multithreading framework allows us to perform tasks in parallel leading to enhanced performance with improved latency.</p><p name="e7ee" id="e7ee" class="graf graf--p graf-after--p">In Java, when you create <code class="markup--code markup--p-code">ThreadPoolExecutor</code> it will create a pool with bounds specified for core pool size, max pool size, and other parameters.</p><p name="f18b" id="f18b" class="graf graf--p graf-after--p">When a new request comes:</p><ul class="postList"><li name="40b1" id="40b1" class="graf graf--li graf-after--p">If the number of threads running is less than <code class="markup--code markup--li-code">corePoolSize</code>, it will create a new thread</li><li name="24dd" id="24dd" class="graf graf--li graf-after--li">If the number of threads running is more than <code class="markup--code markup--li-code">corePoolSize</code> and less than <code class="markup--code markup--li-code">maximumPoolSize</code>, it will queue the request if the queue is not full.</li><li name="bdb1" id="bdb1" class="graf graf--li graf-after--li">If the number of threads running is more than <code class="markup--code markup--li-code">corePoolSize</code> and the queue is full, it will create a new thread unless this would exceed <code class="markup--code markup--li-code">maximumPoolSize</code></li><li name="28db" id="28db" class="graf graf--li graf-after--li">In the third scenario, if the new request exceeds<code class="markup--code markup--li-code">maximumPoolSize</code> , the request will be rejected by default.</li></ul><p name="30ce" id="30ce" class="graf graf--p graf-after--li">In the last case, we will get <code class="markup--code markup--p-code">RejectedExecutionException</code> after the task gets <strong class="markup--strong markup--p-strong">rejected</strong>. This is the default behavior. We could override this using policies in <code class="markup--code markup--p-code">ThreadPoolExecutor</code>.</p><p name="73e4" id="73e4" class="graf graf--p graf-after--p">There are four policies:</p><ol class="postList"><li name="108a" id="108a" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">AbortPolicy- </strong>The <em class="markup--em markup--li-em">default</em> policy that discards the task and throws the <code class="markup--code markup--li-code">RejectedExecutionException.</code> If no policy is specified, this will be applied.</li><li name="4bbf" id="4bbf" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">DiscardPolicy</strong>- Discards the task without any exception</li><li name="a0ec" id="a0ec" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">DiscardOldestPolicy</strong>- Discards the older task without any exception</li><li name="933b" id="933b" class="graf graf--li graf-after--li graf--trailing"><strong class="markup--strong markup--li-strong">CallerRunsPolicy</strong>- The thread that invoked execute in the first place will run the task. This will ensure all tasks are executed without dropping any.</li></ol></div></div></section><section name="c15c" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="14f9" id="14f9" class="graf graf--p graf--leading">Consider the following scenario:</p><ul class="postList"><li name="7565" id="7565" class="graf graf--li graf-after--p">core pool size — 1</li><li name="80ef" id="80ef" class="graf graf--li graf-after--li">max pool size — 5</li><li name="a728" id="a728" class="graf graf--li graf-after--li">queue capacity — 5</li><li name="9236" id="9236" class="graf graf--li graf-after--li">keep alive time for each thread — 0 seconds</li></ul><blockquote name="717a" id="717a" class="graf graf--blockquote graf-after--li"><strong class="markup--strong markup--blockquote-strong">KeepAliveTime</strong>: At any point in time, if pool size is more than configured <code class="markup--code markup--blockquote-code">corePoolSize</code> excess threads will be terminated if they were idle for the <code class="markup--code markup--blockquote-code">keepAliveTime</code> specified.</blockquote><p name="66f4" id="66f4" class="graf graf--p graf-after--blockquote">Let&#39;s see, how each policy behaves under the above configurations.</p><h4 name="7ea7" id="7ea7" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">1. AbortPolicy:</strong></h4><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="java" name="c8a6" id="c8a6" class="graf graf--pre graf-after--h4 graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> java.util.concurrent.*;<br /><span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit.*;<br /><span class="hljs-keyword">import</span> java.time.*;<br /><br /><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span><br />{<br /> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {<br />  <span class="hljs-type">int</span> <span class="hljs-variable">corePoolSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br />  <span class="hljs-type">int</span> <span class="hljs-variable">maxPoolSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">5</span>;<br />  <span class="hljs-type">long</span> <span class="hljs-variable">keepAliveTime</span> <span class="hljs-operator">=</span> <span class="hljs-number">0L</span>;<br />  BlockingQueue&lt;Runnable&gt; queue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="hljs-number">5</span>);<br />  <span class="hljs-type">RejectedExecutionHandler</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.AbortPolicy(); <br />  <br />  <br />  <span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">exec</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(corePoolSize,maxPoolSize,keepAliveTime,java.util.concurrent.TimeUnit.SECONDS, queue,handler);<br />  <br />  <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">16</span>;i++) {<br />      <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">cnt</span> <span class="hljs-operator">=</span>i;<br />      exec.execute(() -&gt; {<br />          <span class="hljs-keyword">try</span>{<br />              System.out.println(<span class="hljs-string">&quot;At time: &quot;</span>+LocalDateTime.now()+<span class="hljs-string">&quot; task:&quot;</span>+cnt+<span class="hljs-string">&quot; &quot;</span>+Thread.currentThread().getName()+<span class="hljs-string">&quot; queue size:&quot;</span>+exec.getQueue().size());<br />              Thread.sleep(<span class="hljs-number">1000</span>);<br />          }<br />          <span class="hljs-keyword">catch</span>(InterruptedException ex ) {<br />              ex.printStackTrace();<br />          }<br />      });<br />  }<br />  exec.shutdown();<br /> }<br />}</span></pre><p name="880a" id="880a" class="graf graf--p graf-after--pre">console log:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="yaml" name="df02" id="df02" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-string">Exception</span> <span class="hljs-string">in</span> <span class="hljs-string">thread</span> <span class="hljs-string">&quot;main&quot;</span> <span class="hljs-attr">java.util.concurrent.RejectedExecutionException:</span> <span class="hljs-string">Task</span> <span class="hljs-string">Main$$Lambda$1/0x0000000100062440@6c629d6e</span> <span class="hljs-string">rejected</span> <span class="hljs-string">from</span> <span class="hljs-string">java.util.concurrent.ThreadPoolExecutor@5ecddf8f[Running,</span> <span class="hljs-string">pool</span> <span class="hljs-string">size</span> <span class="hljs-string">=</span> <span class="hljs-number">5</span><span class="hljs-string">,</span> <span class="hljs-string">active</span> <span class="hljs-string">threads</span> <span class="hljs-string">=</span> <span class="hljs-number">5</span><span class="hljs-string">,</span> <span class="hljs-string">queued</span> <span class="hljs-string">tasks</span> <span class="hljs-string">=</span> <span class="hljs-number">5</span><span class="hljs-string">,</span> <span class="hljs-string">completed</span> <span class="hljs-string">tasks</span> <span class="hljs-string">=</span> <span class="hljs-number">0</span><span class="hljs-string">]</span><br />        <span class="hljs-string">at</span> <span class="hljs-string">java.base/java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2055)</span><br />        <span class="hljs-string">at</span> <span class="hljs-string">java.base/java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:825)</span><br />        <span class="hljs-string">at</span> <span class="hljs-string">java.base/java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1355)</span><br />        <span class="hljs-string">at</span> <span class="hljs-string">Main.main(Main.java:19)</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:47:42.960181 </span><span class="hljs-string">task:0</span> <span class="hljs-string">pool-1-thread-1</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:47:42.959882 </span><span class="hljs-string">task:7</span> <span class="hljs-string">pool-1-thread-3</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:47:42.959947 </span><span class="hljs-string">task:8</span> <span class="hljs-string">pool-1-thread-4</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:47:42.959168 </span><span class="hljs-string">task:9</span> <span class="hljs-string">pool-1-thread-5</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:47:42.959841 </span><span class="hljs-string">task:6</span> <span class="hljs-string">pool-1-thread-2</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:47:44.221735 </span><span class="hljs-string">task:1</span> <span class="hljs-string">pool-1-thread-3</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:4</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:47:44.222723 </span><span class="hljs-string">task:3</span> <span class="hljs-string">pool-1-thread-5</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:2</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:47:44.222546 </span><span class="hljs-string">task:2</span> <span class="hljs-string">pool-1-thread-4</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:3</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:47:44.223902 </span><span class="hljs-string">task:4</span> <span class="hljs-string">pool-1-thread-1</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:1</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:47:44.224844 </span><span class="hljs-string">task:5</span> <span class="hljs-string">pool-1-thread-2</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:0</span></span></pre><p name="c174" id="c174" class="graf graf--p graf-after--pre">As you can see, after the 10th request, the queue and pool got filled up. So, requests made later are rejected with<code class="markup--code markup--p-code">RejectedExecutionException</code></p><h4 name="cca5" id="cca5" class="graf graf--h4 graf-after--p">2. DiscardPolicy:</h4><p name="6337" id="6337" class="graf graf--p graf-after--h4">In the above code update <code class="markup--code markup--p-code">ThreadPoolExecutor</code> as below:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="java" name="a691" id="a691" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-type">RejectedExecutionHandler</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.DiscardPolicy();</span></pre><p name="772b" id="772b" class="graf graf--p graf-after--pre">console logs:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="yaml" name="2eb8" id="2eb8" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:25.659355 </span><span class="hljs-string">task:0</span> <span class="hljs-string">pool-1-thread-1</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:25.659367 </span><span class="hljs-string">task:8</span> <span class="hljs-string">pool-1-thread-4</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:25.659375 </span><span class="hljs-string">task:6</span> <span class="hljs-string">pool-1-thread-2</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:25.659392 </span><span class="hljs-string">task:7</span> <span class="hljs-string">pool-1-thread-3</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:25.659379 </span><span class="hljs-string">task:9</span> <span class="hljs-string">pool-1-thread-5</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:26.849011 </span><span class="hljs-string">task:1</span> <span class="hljs-string">pool-1-thread-1</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:4</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:26.849325 </span><span class="hljs-string">task:2</span> <span class="hljs-string">pool-1-thread-2</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:3</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:26.849529 </span><span class="hljs-string">task:3</span> <span class="hljs-string">pool-1-thread-5</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:2</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:26.850340 </span><span class="hljs-string">task:4</span> <span class="hljs-string">pool-1-thread-4</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:1</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:26.850472 </span><span class="hljs-string">task:5</span> <span class="hljs-string">pool-1-thread-3</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:0</span></span></pre><p name="8240" id="8240" class="graf graf--p graf-after--pre">As you can see, only 10 requests out of 16 are executed. Other requests are discarded silently without any exception.</p><h4 name="8320" id="8320" class="graf graf--h4 graf-after--p">3. CallerRunsPolicy:</h4><p name="eb51" id="eb51" class="graf graf--p graf-after--h4">In the above code update <code class="markup--code markup--p-code">ThreadPoolExecutor</code> as below:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="java" name="7e49" id="7e49" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-type">RejectedExecutionHandler</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.CallerRunsPolicy();</span></pre><p name="c27d" id="c27d" class="graf graf--p graf-after--pre">console log:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="yaml" name="f200" id="f200" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:47.945689 </span><span class="hljs-string">task:7</span> <span class="hljs-string">pool-1-thread-3</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:47.945922 </span><span class="hljs-string">task:8</span> <span class="hljs-string">pool-1-thread-4</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:47.945571 </span><span class="hljs-string">task:9</span> <span class="hljs-string">pool-1-thread-5</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:47.945632 </span><span class="hljs-string">task:6</span> <span class="hljs-string">pool-1-thread-2</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:47.945591 </span><span class="hljs-string">task:10</span> <span class="hljs-string">main</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:47.945319 </span><span class="hljs-string">task:0</span> <span class="hljs-string">pool-1-thread-1</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:49.207264 </span><span class="hljs-string">task:1</span> <span class="hljs-string">pool-1-thread-3</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:4</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:49.207450 </span><span class="hljs-string">task:2</span> <span class="hljs-string">pool-1-thread-4</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:3</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:49.208639 </span><span class="hljs-string">task:3</span> <span class="hljs-string">pool-1-thread-5</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:2</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:49.209616 </span><span class="hljs-string">task:4</span> <span class="hljs-string">pool-1-thread-2</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:49.209651 </span><span class="hljs-string">task:15</span> <span class="hljs-string">main</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:49.210224 </span><span class="hljs-string">task:5</span> <span class="hljs-string">pool-1-thread-1</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:4</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:50.207628 </span><span class="hljs-string">task:11</span> <span class="hljs-string">pool-1-thread-3</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:3</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:50.207696 </span><span class="hljs-string">task:12</span> <span class="hljs-string">pool-1-thread-4</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:2</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:50.208983 </span><span class="hljs-string">task:13</span> <span class="hljs-string">pool-1-thread-5</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:1</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:48:50.209866 </span><span class="hljs-string">task:14</span> <span class="hljs-string">pool-1-thread-2</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:0</span></span></pre><p name="9260" id="9260" class="graf graf--p graf-after--pre">As you can see, the thread pool does not execute two threads as the queue and pool were occupied after 10 requests. They were handled by the caller thread i.e., the <code class="markup--code markup--p-code">main</code> thread in this case.</p><p name="e8ae" id="e8ae" class="graf graf--p graf-after--p">This option makes sure no requests are dropped. But will add a delay and would impact the application&#39;s overall performance.</p><h4 name="3d25" id="3d25" class="graf graf--h4 graf-after--p">4. DiscardOldestPolicy:</h4><p name="6f07" id="6f07" class="graf graf--p graf-after--h4">In the above code update <code class="markup--code markup--p-code">ThreadPoolExecutor</code> as below:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="java" name="366c" id="366c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-type">RejectedExecutionHandler</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.DiscardOldestPolicy();</span></pre><p name="af9a" id="af9a" class="graf graf--p graf-after--pre">console log:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="yaml" name="90ad" id="90ad" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:49:10.266112 </span><span class="hljs-string">task:7</span> <span class="hljs-string">pool-1-thread-3</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:49:10.266096 </span><span class="hljs-string">task:6</span> <span class="hljs-string">pool-1-thread-2</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:49:10.266088 </span><span class="hljs-string">task:0</span> <span class="hljs-string">pool-1-thread-1</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:49:10.266095 </span><span class="hljs-string">task:8</span> <span class="hljs-string">pool-1-thread-4</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:49:10.266100 </span><span class="hljs-string">task:9</span> <span class="hljs-string">pool-1-thread-5</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:5</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:49:11.389160 </span><span class="hljs-string">task:11</span> <span class="hljs-string">pool-1-thread-2</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:4</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:49:11.389814 </span><span class="hljs-string">task:12</span> <span class="hljs-string">pool-1-thread-3</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:3</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:49:11.390154 </span><span class="hljs-string">task:15</span> <span class="hljs-string">pool-1-thread-4</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:0</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:49:11.390034 </span><span class="hljs-string">task:14</span> <span class="hljs-string">pool-1-thread-1</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:1</span><br /><span class="hljs-attr">At time:</span> <span class="hljs-number">2024-10-11T07:49:11.389952 </span><span class="hljs-string">task:13</span> <span class="hljs-string">pool-1-thread-5</span> <span class="hljs-string">queue</span> <span class="hljs-string">size:2</span></span></pre><p name="57fc" id="57fc" class="graf graf--p graf-after--pre graf--trailing">As you can see, the latest 10 requests out of 16 are executed. Other requests are discarded silently without any exception based on their age i.e., when a new request comes, it will discard the initial requests.</p></div></div></section><section name="fdc8" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="cf6f" id="cf6f" class="graf graf--p graf--leading">Apart from the above scenario, there are many other causes of <code class="markup--code markup--p-code">RejectedExecutionException</code>. To handle such scenarios, precisely look for the right configurations for the thread pool.</p><p name="54ab" id="54ab" class="graf graf--p graf-after--p">Thank you for reading. Happy exploring!!!</p><p name="2554" id="2554" class="graf graf--p graf-after--p">References:</p><ul class="postList"><li name="b570" id="b570" class="graf graf--li graf-after--p"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ThreadPoolExecutor.html" data-href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ThreadPoolExecutor.html" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">ThreadPoolExecutor Oracle documentation</a></li><li name="3de9" id="3de9" class="graf graf--li graf-after--li"><a href="https://www.linkedin.com/pulse/understanding-rejectedexecutionexception-java-vaibhav-sahni-w7pec#:~:text=Why%20the%20Exception%3F,tasks%20are%20rejected%2C%20causing%20RejectedExecutionException." data-href="https://www.linkedin.com/pulse/understanding-rejectedexecutionexception-java-vaibhav-sahni-w7pec#:~:text=Why%20the%20Exception%3F,tasks%20are%20rejected%2C%20causing%20RejectedExecutionException." class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">Understanding RejectedExecutionException in Java by Vaibhav Sahni</a></li><li name="497e" id="497e" class="graf graf--li graf-after--li graf--trailing"><a href="https://docs.oracle.com/javase/8/docs/api/index.html?java/util/concurrent/ExecutorService.html" data-href="https://docs.oracle.com/javase/8/docs/api/index.html?java/util/concurrent/ExecutorService.html" class="markup--anchor markup--li-anchor" rel="noopener" target="_blank">ExecutorService Oracle documentation</a></li></ul></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@ankithahjpgowda" class="p-author h-card">Ankitha Gowda</a> on <a href="https://medium.com/p/75f22fd6f637"><time class="dt-published" datetime="2024-10-12T16:13:11.577Z">October 12, 2024</time></a>.</p><p><a href="https://medium.com/@ankithahjpgowda/policies-of-threadpoolexecutor-in-java-75f22fd6f637" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 9, 2025.</p></footer></article></body></html>