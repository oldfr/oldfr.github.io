<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Update Hostname dynamically in Spring Cloud Gateway</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Update Hostname dynamically in Spring Cloud Gateway</h1>
</header>
<section data-field="subtitle" class="p-summary">
API gateway is a middleware between the client and the backend services. We could intercept each request received from the client and…
</section>
<section data-field="body" class="e-content">
<section name="9f83" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="50ce" id="50ce" class="graf graf--h3 graf--leading graf--title">Update Hostname dynamically in Spring Cloud Gateway</h3><figure name="f359" id="f359" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="0*EQj3hObA4SXuHt7Z" data-width="4480" data-height="6720" data-unsplash-photo-id="faS2GhY1fjE" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/0*EQj3hObA4SXuHt7Z"><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/@nate_dumlao?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com/@nate_dumlao?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-creator noopener" target="_blank">Nathan Dumlao</a> on <a href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" data-href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" class="markup--anchor markup--figure-anchor" rel="photo-source noopener" target="_blank">Unsplash</a></figcaption></figure><p name="7147" id="7147" class="graf graf--p graf--hasDropCapModel graf--hasDropCap graf-after--figure graf--trailing"><span class="graf-dropCap">A</span>PI gateway is a middleware between the client and the backend services. We could intercept each request received from the client and perform customized operations using <strong class="markup--strong markup--p-strong">Filters</strong> to log request/response details or manipulate requests before forwarding them to the target internal service.</p></div></div></section><section name="b0a5" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="d8a8" id="d8a8" class="graf graf--p graf--leading">Let&#39;s say the gateway will receive an API call having query parameter <em class="markup--em markup--p-em">locality</em> and must determine the target host based on its value. For example, when a gateway is available in the host <code class="markup--code markup--p-code">gateway.nothing.com</code>and the request is made with the query parameter<code class="markup--code markup--p-code">locality=germany</code>, it should route to the host <code class="markup--code markup--p-code">gatewaygermanyservice.nothing.com</code></p><p name="44fc" id="44fc" class="graf graf--p graf-after--p">We would need the below dependencies for the spring gateway in the <code class="markup--code markup--p-code">pom.xml</code> file:</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="xml" name="ec5a" id="ec5a" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br />  <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>11<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span><br />  <span class="hljs-tag">&lt;<span class="hljs-name">spring-cloud.version</span>&gt;</span>2021.0.8<span class="hljs-tag">&lt;/<span class="hljs-name">spring-cloud.version</span>&gt;</span><br /> <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br /> <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br />  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br />   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br />   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br />  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br />    ...<br /> <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br /> <span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span><br />  <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br />   <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br />    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br />    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br />    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${spring-cloud.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br />    <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br />    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br />   <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br />  <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br /> <span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span></span></pre><p name="cdcc" id="cdcc" class="graf graf--p graf-after--pre">Specify routing configurations in <code class="markup--code markup--p-code">RouteLocator</code> bean:</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="java" name="11b3" id="11b3" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">package</span> com.example.api.gateway.hostupdate.config;<br /><br /><span class="hljs-keyword">import</span> com.example.api.gateway.hostupdate.filter.HostFilter;<br /><span class="hljs-keyword">import</span> com.example.api.gateway.hostupdate.filter.RequestFilter;<br /><span class="hljs-keyword">import</span> org.springframework.cloud.gateway.route.RouteLocator;<br /><span class="hljs-keyword">import</span> org.springframework.cloud.gateway.route.builder.RouteLocatorBuilder;<br /><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br /><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br /><br /><span class="hljs-meta">@Configuration</span><br /><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainConfig</span> {<br /><br /><span class="hljs-meta">@Bean</span><br /><span class="hljs-keyword">public</span> RouteLocator <span class="hljs-title function_">routes</span><span class="hljs-params">(<br />        RouteLocatorBuilder builder,<br />        HostFilter hostFilter,<br />        RequestFilter requestFilter)</span> {<br /><span class="hljs-keyword">return</span> builder.routes()<br />        .route(<span class="hljs-string">&quot;custom-route-1&quot;</span>,<br />            r -&gt; r.path(<span class="hljs-string">&quot;/red&quot;</span>)<br />                  .filters(f -&gt;<br />                          f.filter(requestFilter) <span class="hljs-comment">// to log initial request details</span><br />                            .filter(hostFilter.apply(<br />                                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HostFilter</span>.Config())) <span class="hljs-comment">// to update hostname</span><br />                            .filter(requestFilter) <span class="hljs-comment">// to log request details after hostname update</span><br />                  )<br />                  .uri(<span class="hljs-string">&quot;http://dummyhost.xyz.com&quot;</span>)) <span class="hljs-comment">// the dummy destination host that will be overridden by HostFilter</span><br />        .build();<br />}<br />}</span></pre><p name="881b" id="881b" class="graf graf--p graf-after--pre">Here, for incoming path — <code class="markup--code markup--p-code">/red</code> we are</p><ol class="postList"><li name="7f31" id="7f31" class="graf graf--li graf-after--p">Applying <code class="markup--code markup--li-code">RequestFilter</code>, to log initial request details.</li><li name="179e" id="179e" class="graf graf--li graf-after--li">Applying <code class="markup--code markup--li-code">HostFilter</code>, to update the hostname.</li><li name="5507" id="5507" class="graf graf--li graf-after--li">Applying <code class="markup--code markup--li-code">RequestFilter</code> again, to log the request details to validate the hostname update.</li><li name="c91e" id="c91e" class="graf graf--li graf-after--li">Setting the target host to which the request needs to be forwarded. This value will be updated by <code class="markup--code markup--li-code">HostFilter</code></li></ol><p name="57ff" id="57ff" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">RequestFilter:</strong></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="kotlin" name="6c70" id="6c70" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">package</span> com.example.api.gateway.hostupdate.filter;<br /><br /><span class="hljs-keyword">import</span> org.springframework.cloud.gateway.filter.GatewayFilter;<br /><span class="hljs-keyword">import</span> org.springframework.cloud.gateway.filter.GatewayFilterChain;<br /><span class="hljs-keyword">import</span> org.springframework.cloud.gateway.route.Route;<br /><span class="hljs-keyword">import</span> org.springframework.core.Ordered;<br /><span class="hljs-keyword">import</span> org.springframework.core.<span class="hljs-keyword">annotation</span>.Order;<br /><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br /><span class="hljs-keyword">import</span> org.springframework.web.server.ServerWebExchange;<br /><span class="hljs-keyword">import</span> reactor.core.publisher.Mono;<br /><br /><span class="hljs-keyword">import</span> static org.springframework.cloud.gateway.support.ServerWebExchangeUtils.GATEWAY_ROUTE_ATTR;<br /><br /><span class="hljs-meta">@Component</span><br /><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestFilter</span> <span class="hljs-title">implements</span> <span class="hljs-title">GatewayFilter</span> {<br /><br />    <span class="hljs-meta">@Override</span><br />    <span class="hljs-keyword">public</span> Mono&lt;<span class="hljs-built_in">Void</span>&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) {<br />        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;In Request Filter&quot;</span>);<br />        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;Original Request URL:&quot;</span>+exchange.getRequest().getURI());<br />        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;Target hostname:&quot;</span>+((Route)exchange.getAttributes().<span class="hljs-keyword">get</span>(GATEWAY_ROUTE_ATTR)).getUri());<br />        <span class="hljs-keyword">return</span> chain.filter(exchange);<br />    }<br />}</span></pre><p name="ae21" id="ae21" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">HostFilter, to update the hostname:</strong></p><p name="99ca" id="99ca" class="graf graf--p graf-after--p">This is a customized filter created by overriding the interface <code class="markup--code markup--p-code">AbstractGatewayFilterFactory&lt;C&gt;</code></p><p name="6190" id="6190" class="graf graf--p graf-after--p">where, C is <code class="markup--code markup--p-code">AbstractConfigurable</code> class that provides basic functionality but does not store any data.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="java" name="1e01" id="1e01" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">package</span> com.example.api.gateway.hostupdate.filter;<br /><br /><span class="hljs-keyword">import</span> org.springframework.cloud.gateway.filter.GatewayFilter;<br /><span class="hljs-keyword">import</span> org.springframework.cloud.gateway.filter.factory.AbstractGatewayFilterFactory;<br /><span class="hljs-keyword">import</span> org.springframework.cloud.gateway.route.Route;<br /><span class="hljs-keyword">import</span> org.springframework.core.Ordered;<br /><span class="hljs-keyword">import</span> org.springframework.core.annotation.Order;<br /><span class="hljs-keyword">import</span> org.springframework.http.server.reactive.ServerHttpRequest;<br /><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br /><span class="hljs-keyword">import</span> org.springframework.web.server.ServerWebExchange;<br /><span class="hljs-keyword">import</span> org.springframework.web.util.UriComponentsBuilder;<br /><br /><span class="hljs-keyword">import</span> java.net.URI;<br /><br /><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.springframework.cloud.gateway.support.ServerWebExchangeUtils.GATEWAY_ROUTE_ATTR;<br /><br /><span class="hljs-meta">@Component</span><br /><span class="hljs-meta">@Order(Ordered.HIGHEST_PRECEDENCE + 1)</span><br /><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HostFilter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractGatewayFilterFactory</span>&lt;HostFilter.Config&gt; {<br /><br />    <span class="hljs-type">String</span> <span class="hljs-variable">domain</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;.nothing.com&quot;</span>; <span class="hljs-comment">//provide domain name here</span><br /><br />    <span class="hljs-meta">@Override</span><br />    <span class="hljs-keyword">public</span> GatewayFilter <span class="hljs-title function_">apply</span><span class="hljs-params">(Config config)</span> {<br />        <span class="hljs-keyword">return</span> (exchange, chain) -&gt; {<br />            System.out.println(<span class="hljs-string">&quot;Applying HostName filter&quot;</span>);<br />            <span class="hljs-type">ServerHttpRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> exchange.getRequest();<br />            <span class="hljs-type">String</span> <span class="hljs-variable">incomingHost</span> <span class="hljs-operator">=</span> request.getURI().getHost();;<br />            <span class="hljs-type">String</span> <span class="hljs-variable">location</span> <span class="hljs-operator">=</span> request.getQueryParams().getFirst(<span class="hljs-string">&quot;locality&quot;</span>);<br />            <span class="hljs-type">String</span> <span class="hljs-variable">updatedHost</span> <span class="hljs-operator">=</span> incomingHost.replace(domain, location+domain);<br /><br />            <span class="hljs-type">URI</span> <span class="hljs-variable">updatedUri</span> <span class="hljs-operator">=</span><br />                    UriComponentsBuilder.fromUri(exchange.getRequest().getURI())<br />                            .scheme(<span class="hljs-string">&quot;http&quot;</span>) <span class="hljs-comment">// provide scheme of host</span><br />                            .host(updatedHost)<br />                            .port(<span class="hljs-number">8080</span>) <span class="hljs-comment">// replace with respective port</span><br />                            .build().toUri();<br /><br />            <span class="hljs-type">ServerWebExchange</span> <span class="hljs-variable">modifiedExchange</span> <span class="hljs-operator">=</span> updateExchange(exchange, updatedUri);<br />            System.out.println(<span class="hljs-string">&quot;updatedUri:&quot;</span>+updatedUri);<br />            System.out.println(<span class="hljs-string">&quot;updatedHost:&quot;</span>+updatedHost);<br />            System.out.println(<span class="hljs-string">&quot;Applying HostName filter completed.. &quot;</span>);<br />            <span class="hljs-keyword">return</span> chain.filter(modifiedExchange);<br />        };<br />    }<br /><br />    <span class="hljs-keyword">private</span> ServerWebExchange <span class="hljs-title function_">updateExchange</span><span class="hljs-params">(ServerWebExchange exchange, URI updatedUri )</span> {<br />        <span class="hljs-type">ServerWebExchange</span> <span class="hljs-variable">modifiedExchange</span> <span class="hljs-operator">=</span> exchange.mutate().build();<br />        <span class="hljs-type">Route</span> <span class="hljs-variable">route</span> <span class="hljs-operator">=</span> exchange.getAttribute(GATEWAY_ROUTE_ATTR);<br /><br />        <span class="hljs-comment">// create new Route object based on old route and updatedURI</span><br />        <span class="hljs-type">Route</span> <span class="hljs-variable">newRoute</span> <span class="hljs-operator">=</span> Route.async()<br />                .id(route.getId())<br />                .uri(updatedUri)<br />                .order(route.getOrder())<br />                .asyncPredicate(route.getPredicate()).build();<br /><br />        newRoute.getPredicate().apply(exchange);<br /><br />        <span class="hljs-comment">// This step is mandatory as GATEWAY_ROUTE_ATTR will only be set once when gateway property is set.</span><br />        <span class="hljs-comment">// To update host, you need to update this attribute</span><br />        modifiedExchange.getAttributes().put(GATEWAY_ROUTE_ATTR,newRoute); <br /><br />        System.out.println(<span class="hljs-string">&quot;returning modifiedExchange&quot;</span>);<br />        <span class="hljs-keyword">return</span> modifiedExchange;<br />    }<br /><br />    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Config</span> {<br /><br />    }<br />}</span></pre><p name="89d3" id="89d3" class="graf graf--p graf-after--pre">In the above filter, we recreate the <code class="markup--code markup--p-code">ServerWebExchange</code> object with a new hostname and replace <strong class="markup--strong markup--p-strong">GATEWAY_ROUTE_ATTR </strong>attribute<strong class="markup--strong markup--p-strong"> </strong>with new route details.</p><p name="78f5" id="78f5" class="graf graf--p graf-after--p">Internally when your gateway application loads, it will set all route values based on your <code class="markup--code markup--p-code">RouteLocator</code> bean configuration. In this example, the initial destination host will be <code class="markup--code markup--p-code"><a href="http://dummyhost.xyz.com" data-href="http://dummyhost.xyz.com" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">http://dummyhost.xyz.com</a></code> set by <code class="markup--code markup--p-code">RoutePredicateHandlerMapping</code> class. After applying <code class="markup--code markup--p-code">HostFilter</code>, this value will be overridden. You can observe the old and new values when you debug the request flow.</p><p name="5fc9" id="5fc9" class="graf graf--p graf-after--p graf--trailing">At the end of the filter, we are calling <code class="markup--code markup--p-code">chain.filter(modifiedExchange)</code> so that the updated details will be used in the next filter.</p></div></div></section><section name="b88a" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="5701" id="5701" class="graf graf--p graf--leading"><strong class="markup--strong markup--p-strong">Execution</strong></p><p name="b006" id="b006" class="graf graf--p graf-after--p graf--trailing">Suppose you deploy the above code changes under host <code class="markup--code markup--p-code">gateway.nothing.com</code> and invoke the API: <strong class="markup--strong markup--p-strong">http://&lt;gateway.nothing.com&gt;:8080/red?locality=germany.</strong> Your request will be routed to the target host: <code class="markup--code markup--p-code">gatewaygermanyservice.nothing.com</code>, if available. If not, you will get <code class="markup--code markup--p-code">UnknownHostException</code>.</p></div></div></section><section name="0966" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="bb63" id="bb63" class="graf graf--p graf--leading"><strong class="markup--strong markup--p-strong">Update hostname based on parameter from request body:</strong></p><p name="7525" id="7525" class="graf graf--p graf-after--p">Similarly, we can update the hostname based on values from the incoming payload. To read the payload, we need to provide <code class="markup--code markup--p-code">readBody</code> as true with the corresponding datatype in <code class="markup--code markup--p-code">RouteLocator</code> bean configuration.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="less" name="1b9d" id="1b9d" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-selector-class">.route</span>(<span class="hljs-string">&quot;custom-route-2&quot;</span>,<br />        r -&gt; r.<span class="hljs-built_in">path</span>(<span class="hljs-string">&quot;/green&quot;</span>)<br />                .<span class="hljs-built_in">and</span>().<span class="hljs-built_in">method</span>(HttpMethod.POST)<br />                .<span class="hljs-built_in">and</span>()<br />                .<span class="hljs-built_in">readBody</span>(Map.class,s -&gt; true)<br />                .<span class="hljs-built_in">filters</span>(f -&gt;<br />                        f.<span class="hljs-built_in">filter</span>(requestFilter) <span class="hljs-comment">// to log initial request details</span><br />                                .<span class="hljs-built_in">filter</span>(hostFilter.<span class="hljs-built_in">apply</span>(<br />                                        new HostFilter.<span class="hljs-built_in">Config</span>()))<br />                                .<span class="hljs-built_in">filter</span>(requestFilter) <span class="hljs-comment">// to log request details after hostname update</span><br />                )<br />                .<span class="hljs-built_in">uri</span>(<span class="hljs-string">&quot;http://dummyhost.xyz.com&quot;</span>))</span></pre><p name="2a7c" id="2a7c" class="graf graf--p graf-after--pre">Update <code class="markup--code markup--p-code">apply()</code> method in <code class="markup--code markup--p-code">HostFilter</code> class to get the details from the payload using <code class="markup--code markup--p-code">cachedRequestBodyObject</code> attribute in exchange and use it as required.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="5365" id="5365" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">    <span class="hljs-meta">@Override</span><br />    <span class="hljs-keyword">public</span> <span class="hljs-title class_">GatewayFilter</span> <span class="hljs-title function_">apply</span>(<span class="hljs-params">Config config</span>) {<br />        <span class="hljs-keyword">return</span> (exchange, chain) -&gt; {<br />                <br />                <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">String</span>&gt; body = exchange.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&quot;cachedRequestBodyObject&quot;</span>);<br />                <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">&quot;read body:&quot;</span>+body);<br />                <span class="hljs-comment">// process the body and update host</span><br /><br />                <span class="hljs-keyword">return</span> chain.<span class="hljs-title function_">filter</span>(modifiedExchange);<br />        };<br />    }</span></pre><blockquote name="1c80" id="1c80" class="graf graf--blockquote graf-after--pre">Note: Complete details about API gateway can be found in the article <a href="https://medium.com/@ankithahjpgowda/api-gateway-in-spring-boot-3ea804003021" data-href="https://medium.com/@ankithahjpgowda/api-gateway-in-spring-boot-3ea804003021" class="markup--anchor markup--blockquote-anchor" target="_blank">API gateway in Spring boot</a></blockquote><p name="0b8e" id="0b8e" class="graf graf--p graf-after--blockquote">The complete code of the above example is available <a href="https://github.com/oldfr/api-gateway-update-host-filter" data-href="https://github.com/oldfr/api-gateway-update-host-filter" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">here</a></p><p name="9f6d" id="9f6d" class="graf graf--p graf-after--p graf--trailing">Thank you for reading. Happy exploring!!!</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@ankithahjpgowda" class="p-author h-card">Ankitha Gowda</a> on <a href="https://medium.com/p/d6e9ffbfe0f6"><time class="dt-published" datetime="2025-01-18T09:39:00.818Z">January 18, 2025</time></a>.</p><p><a href="https://medium.com/@ankithahjpgowda/update-hostname-dynamically-in-spring-cloud-gateway-d6e9ffbfe0f6" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 9, 2025.</p></footer></article></body></html>